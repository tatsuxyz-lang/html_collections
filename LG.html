<!DOCTYPE html>
<html lang=ja><head><meta charset=UTF-8><title>ECO V.3.5</title><style>:root{--n:#00ff41;--d:#ff0033;--b:#000}body{background:var(--b);color:var(--n);font-family:Courier New,monospace;display:flex;flex-direction:column;align-items:center;margin:0;overflow:hidden}body::before{content:" ";position:absolute;inset:0;background:linear-gradient(rgba(18,16,16,0)50%,rgba(0,0,0,.25)50%),linear-gradient(90deg,rgba(255,0,0,.04),rgba(0,255,0,.01),rgba(0,0,255,.04));z-index:100;background-size:100% 4px,3px 100%;pointer-events:none}@keyframes f{0%{opacity:.12}50%{opacity:.03}100%{opacity:.11}}body::after{content:"";position:absolute;inset:0;background:rgba(18,16,16,.1);opacity:0;z-index:101;animation:f .12s infinite}canvas{border:1px solid #333;cursor:crosshair;image-rendering:pixelated;background:#000;box-shadow:0 0 20px rgba(0,255,65,.1)}.c{padding:10px;display:flex;flex-wrap:wrap;gap:8px;background:#111;width:100%;justify-content:center;border-bottom:2px solid var(--n);z-index:110;position:relative}button{background:#000;color:var(--n);border:1px solid var(--n);padding:4px 10px;cursor:pointer;font-family:monospace;font-size:11px;transition:.2s}button:hover{background:var(--n);color:#000}button.active{background:var(--n);color:#000;font-weight:bold}#c.active{background:var(--d);color:#fff;border-color:#fff;animation:blink .2s infinite}#l{position:absolute;right:10px;top:120px;width:200px;height:60%;background:rgba(0,0,0,.7);border:1px solid #333;padding:8px;font-size:9px;overflow:hidden;z-index:105;pointer-events:none;opacity:.8}.e{margin-bottom:6px;border-left:2px solid var(--n);padding-left:5px;animation:slideIn .3s ease-out;line-height:1.2}.r{border-left-color:var(--d);color:var(--d)}@keyframes slideIn{from{transform:translateX(20px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}</style></head><body onclick="resumeAudio()"><div class=c><button onclick="setTheme('BIO')" id="btn-BIO">BIO</button><button onclick="setTheme('SKY')" id="btn-SKY">SKY</button><button onclick="setTheme('SAGE')" id="btn-SAGE">SAGE</button><button onclick="setTheme('EARTH')" id="btn-EARTH">EARTH</button><button onclick="toggleCrazy()" id="crazy-btn">Crazy-Nuts!!!</button><button onclick="reset()">PURGE</button><button onclick="randomSeed()">INJECT</button><button id="audio-toggle" onclick="toggleAudio()">SOUND OFF</button><div style="font-size:11px;margin-left:10px;">GEN: <span id="gen">0</span> <span id="warn" class="warning" style="color:var(--d);font-weight:bold;animation:blink .5s infinite;visibility:hidden;margin-left:10px;">!! CRISIS !!</span></div></div><div id="log-container"></div><canvas id="lifeCanvas"></canvas><script>const c=document.getElementById('lifeCanvas'),x=c.getContext('2d'),s=10;let w,h,g,t,n=0,a=0,u,i=0,crazy=0;const th={BIO:{m:'#00ff41',v:'#ff0033',a:'#ffffff',tr:'0,255,65'},SKY:{m:'#00d4ff',v:'#ff00ff',a:'#fff700',tr:'0,212,255'},SAGE:{m:'#9dc183',v:'#722f37',a:'#fdf5e6',tr:'157,193,131'},EARTH:{m:'#d2b48c',v:'#8b4513',a:'#f0fff0',tr:'210,180,140'}};let ct=th.BIO;const d={p:["凪","加速","平和","偽"],dn:["影","悪意","葛藤","体温"],cr:["絶滅！","抵抗","臨界","無"],rb:["芽","復活","回帰","ただいま"],cz:["Crazy!!!","混沌","記号","溶ける"]};function setTheme(k){ct=th[k];crazy=0;document.querySelectorAll('.c button').forEach(b=>b.classList.remove('active'));document.getElementById('btn-'+k).classList.add('active');document.documentElement.style.setProperty('--n',ct.m);document.getElementById('crazy-btn').classList.remove('active')}function toggleCrazy(){crazy=!crazy;document.getElementById('crazy-btn').classList.toggle('active')}function log(){const l=document.getElementById('log-container'),e=document.createElement('div');let lc=0,vc=0;g.forEach(c=>c.forEach(r=>{if(r>=1)lc++;if(r===3)vc++}));let p=crazy?cz:(lc<30?rb:(lc<80?cr:(vc>20?dn:p)));e.className=(p===cr||p===dn)?'e r':'e';e.innerText=`[GEN ${n}] ${p[Math.floor(Math.random()*p.length)]}`;l.prepend(e);if(l.children.length>12)l.removeChild(l.lastChild)}function hb(v,f,d){if(!a||!u||u.state!=='running')return;const o=u.createOscillator(),g=u.createGain();o.type='sine';o.frequency.setValueAtTime(f,u.currentTime);o.frequency.exponentialRampToValueAtTime(.01,u.currentTime+d);g.gain.setValueAtTime(v,u.currentTime);g.gain.exponentialRampToValueAtTime(.01,u.currentTime+d);o.connect(g);g.connect(u.destination);o.start();o.stop(u.currentTime+d)}function toggleAudio(){if(!u)u=new(window.AudioContext||window.webkitAudioContext);a=!a;const b=document.getElementById('audio-toggle');b.innerText=a?"SOUND ON":"SOUND OFF";b.classList.toggle('active',a)}function init(){c.width=window.innerWidth;c.height=window.innerHeight-150;w=Math.floor(c.width/s);h=Math.floor(c.height/s);g=Array.from({length:w},()=>Array(h).fill(0));t=Array.from({length:w},()=>Array(h).fill(0))}function draw(){x.fillStyle='rgba(0,0,0,.3)';x.fillRect(0,0,c.width,c.height);let nx=g.map(a=>[...a]),lc=0,vc=0;g.forEach(c=>c.forEach(e=>{if(e>=1)lc++;if(e===3)vc++}));const sd=(vc/(lc+1))>.8;for(let i=0;i<w;i++)for(let j=0;j<h;j++){let st=g[i][j],nb=neib(g,i,j);if(st>=1){t[i][j]=Math.min(t[i][j]+.1,1);if(st===3){if(sd||nb<1||nb>3)nx[i][j]=0}else{if(nb<2||nb>3)nx[i][j]=(st===2)?1:0}if(st===1&&hasV(g,i,j)&&Math.random()>.6)nx[i][j]=3;if(st===2&&hasV(g,i,j))inf(nx,i,j,1)}else{if(nb===3)nx[i][j]=Math.random()<.02?2:1;t[i][j]*=.96}if(st>=1){let cl=crazy?`hsl(${Math.random()*360},100%,50%)`:(st===3?ct.v:(st===2?ct.a:ct.m));x.fillStyle=cl;x.fillRect(i*s,j*s,s-1,s-1)}else if(t[i][j]>.01){x.fillStyle=`rgba(${ct.tr},${t[i][j]*.08})`;x.fillRect(i*s,j*s,s-1,s-1)}}const ic=lc>0&&lc<50;if(lc>0&&n%(ic?25:60)===0)hb(.4,ic?65:45,.2);if(n%400===0)log();document.getElementById('warn').style.visibility=ic?'visible':'hidden';g=nx;document.getElementById('gen').innerText=n++;requestAnimationFrame(draw)}function neib(g,x,y){let s=0;for(let i=-1;i<2;i++)for(let j=-1;j<2;j++){let a=(x+i+w)%w,b=(y+j+h)%h;if(g[a][b]>=1)s++}return s-(g[x][y]>=1?1:0)}function hasV(g,x,y){for(let i=-1;i<2;i++)for(let j=-1;j<2;j++){let a=(x+i+w)%w,b=(y+j+h)%h;if(g[a][b]===3)return true}return false}function inf(n,x,y,t){for(let i=-1;i<2;i++)for(let j=-1;j<2;j++){let a=(x+i+w)%w,b=(y+j+h)%h;if(n[a][b]===3)n[a][b]=t}}function rs(){for(let i=0;i<500;i++)g[Math.floor(Math.random()*w)][Math.floor(Math.random()*h)]=1}function reset(){g=Array.from({length:w},()=>Array(h).fill(0));t=Array.from({length:w},()=>Array(h).fill(0));n=0}function resumeAudio(){if(u&&u.state==='suspended')u.resume()}init();setTheme('BIO');draw();setInterval(()=>{let c=0;g.forEach(a=>a.forEach(r=>{if(r>=1)c++}));if(c<20){const x=Math.floor(Math.random()*(w-5)),y=Math.floor(Math.random()*(h-5));[[0,1],[1,2],[2,0],[2,1],[2,2]].forEach(([d,e])=>{if(g[x+d])g[x+d][y+e]=1})}},4000);setInterval(()=>{if(Math.random()<.2){const x=Math.floor(Math.random()*w),y=Math.floor(Math.random()*h);if(g[x])g[x][y]=3}},10000);</script></body></html>
