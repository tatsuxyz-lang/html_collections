<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CHAOS-GLASS - d(^_^o)</title>
    <style>
        body { background: #050505; color: #00ff41; font-family: monospace; margin: 0; overflow: hidden; touch-wrap: none; touch-action: none; }
        #canvas { width: 100vw; height: 100vh; display: block; }
        .ui { position: fixed; top: 10px; left: 10px; pointer-events: none; opacity: 0.7; }
        .msg { position: fixed; bottom: 20px; right: 20px; font-size: 10px; opacity: 0.4; }
    </style>
</head>
<body>
    <div class="ui">
        <div>PARTICLES: <span id="time-val">0</span></div>
        <div>GRAVITY: <span id="energy-val">0</span></div>
    </div>
    <div class="msg">ã‚¿ãƒƒãƒ—ã§ã€Œç ‚ã€ã‚’æ”¾æµã—ã‚ã€‚PCã¯ã‚¯ãƒªãƒƒã‚¯ã€‚ã‚‹ã‚‹ã‚‹ã‚‹ã€‚</div>
    <canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    let width, height;

    function init() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', init);
    init();

    class Particle {
        constructor(x, y) {
            this.x = x;
            this.y = y;
            this.vx = (Math.random() - 0.5) * 10;
            this.vy = (Math.random() - 0.5) * 10;
            this.size = Math.random() * 5 + 20; // æ–‡å­—ã‚’å°‘ã—å¤§ããã—ã¾ã—ãŸ
            
            // â˜…ã“ã“ã‚’ç›´ã—ã¾ã—ãŸï¼æ–‡å­—ã®ãƒªã‚¹ãƒˆã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã¶
            const chars = ['ã‚‚', 'ã‚ˆ', 'ç¬ ', 'äº•', 'å±±', 'ã‚‹', 'ğŸŸ'];
            this.char = chars[Math.floor(Math.random() * chars.length)];
        }
        update(gx, gy) {
            this.vx += gx;
            this.vy += gy;
            this.x += this.vx;
            this.y += this.vy;
            this.vx *= 0.98; 
            this.vy *= 0.98;

            if (this.x < 0 || this.x > width) this.vx *= -0.8;
            if (this.y < 0 || this.y > height) this.vy *= -0.8;
            this.x = Math.max(0, Math.min(width, this.x));
            this.y = Math.max(0, Math.min(height, this.y));
        }
        draw() {
            ctx.fillStyle = '#00ff41';
            ctx.font = this.size + 'px monospace'; // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’æŒ‡å®š
            ctx.fillText(this.char, this.x, this.y);
        }
    }

    let gx = 0, gy = 0.5; 
    window.addEventListener('deviceorientation', (e) => {
        // iPhoneãªã©ã¯ã“ã“ãŒå‹•ã‹ãªã„ã‘ã©ã€ãã‚Œã§OKï¼
        gx = (e.gamma || 0) * 0.1;
        gy = (e.beta || 0) * 0.1;
    });

    // ã‚¿ãƒƒãƒ—ã‚„ã‚¯ãƒªãƒƒã‚¯ã§ç²’å­ã‚’å‡ºã™
    const addParticles = (e) => {
        const x = e.clientX || (e.touches && e.touches[0].clientX);
        const y = e.clientY || (e.touches && e.touches[0].clientY);
        for(let i=0; i<15; i++) {
            particles.push(new Particle(x, y));
        }
        if(navigator.vibrate) navigator.vibrate(20);
    };

    canvas.addEventListener('mousedown', addParticles);
    canvas.addEventListener('touchstart', addParticles);

    function loop() {
        ctx.fillStyle = 'rgba(5, 5, 5, 0.2)'; // æ®‹åƒã‚’æ®‹ã™
        ctx.fillRect(0, 0, width, height);
        
        particles.forEach(p => {
            p.update(gx, gy);
            p.draw();
        });

        if (particles.length > 300) particles.shift(); // æºœã¾ã‚Šã™ãé˜²æ­¢

        document.getElementById('time-val').innerText = particles.length;
        document.getElementById('energy-val').innerText = Math.floor(Math.abs(gx) + Math.abs(gy));
        
        requestAnimationFrame(loop);
    }
    loop();
</script>
</body>
</html>
